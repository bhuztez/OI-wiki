
<!doctype html>
<html>
<head>
<title>
插入排序
 -
OI Wiki</title>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link rel="stylesheet" href="/OI-wiki/static/base.css">

</head>
<body>

<div class="navbar">
<nav>
<a href="/OI-wiki/"><i class="material-icons">school</i> OI Wiki</a>
</nav>
</div>

<main>

<article>
<h1>插入排序

<a href="https://github.com/OI-wiki/OI-wiki/blob/master/wiki/insertion-sort.md"><i class="material-icons">create</i></a>
<a href="https://github.com/OI-wiki/OI-wiki/commits/master/wiki/insertion-sort.md"><i class="material-icons">history</i></a></h1>






<p>插入排序将数列划分为“已排序的”和“未排序的”两部分，每次从“未排序的”元素中选择一个插入到“已排序的”元素中的正确位置。</p>
<p>插入排序的最坏情况时间复杂度和平均情况时间复杂度都为 <span class="arithmatex">\(O(n^2)\)</span> ，但其在数列几乎有序时效率很高。</p>
<p>插入排序是一个稳定排序。</p>
<p>伪代码：</p>
<div class="arithmatex">\[
\begin{array}{ll}
1 &amp; \textbf{Input. } \text{An array } A \text{ consisting of }n\text{ elements.} \\
2 &amp; \textbf{Output. } A\text{ will be sorted in nondecreasing order stably.} \\
3 &amp; \textbf{Method. }  \\
4 &amp; \textbf{for } i\gets 2\textbf{ to }n\\
5 &amp; \qquad key\gets A[i]\\
6 &amp; \qquad j\gets i-1\\
7 &amp; \qquad\textbf{while }j&gt;0\textbf{ and }A[j]&gt;key\\
8 &amp; \qquad\qquad A[j + 1]\gets A[j]\\
9 &amp; \qquad\qquad j\gets j - 1\\
10 &amp; \qquad A[j + 1]\gets key
\end{array}
\]</div>
<p>C++ 代码：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">insertion_sort</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">key</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">a</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
      <span class="o">--</span><span class="n">j</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">a</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>
<a href="/OI-wiki/tagged/sort.html">排序</a>
</p>

</article>

</main>

<footer>
<p>&copy; 2016-2019 OI Wiki Team</p>

<p>本页面的全部内容在 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC BY-SA 4.0</a> 和 <a href="https://github.com/zTrix/sata-license">SATA</a> 协议之条款下提供，附加条款亦可能应用
</p>





</footer>

</body>
</html>
